<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Songs that remind me of u</title>
  <style>
    .controls { display: flex; justify-content: center; gap: 20px; margin-top: 10px; }
    .controls button {
      background: #e8c8ff;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .controls button:hover { transform: scale(1.1); }

    audio { width: 100%; margin-top: 10px; border-radius: 10px; }

    /* some basic layout */
    .container { max-width: 700px; margin: 40px auto; text-align: center; font-family: Arial, sans-serif; }
    .player { display: none; }
    .album { width: 200px; height: 200px; object-fit: cover; border-radius: 12px; }
    .song-title { font-weight: bold; margin-top: 10px; }
    .artist { color: #666; margin-bottom: 10px; }
    .start-btn { background:#ffdaec; border:none; padding:16px 20px; border-radius:12px; cursor:pointer; font-size:16px; }
  </style>
</head>
<body>

<script>
for (let i = 0; i < 30; i++) { // more hearts
  const heart = document.createElement("div");
  heart.className = "heart";
  heart.innerHTML = "♡";
  heart.style.left = Math.random() * 100 + "vw";
  heart.style.top = Math.random() * 100 + "vh";
  heart.style.animationDuration = (4 + Math.random() * 4) + "s";
  document.body.appendChild(heart);
}
</script>

<div class="container">
  <button class="start-btn" id="startBtn">i made you something, click me ♡</button>

  <div class="player" id="player">
    <h2>songs that remind me of you ♡</h2>

    <img class="album" id="albumCover" src="">
    <div class="song-title" id="songTitle"></div>
    <div class="artist" id="artist"></div>

    <!-- native audio element (used for local mp3 files) -->
    <audio id="audio" controls></audio>

    <div class="controls">
      <button id="playBtn" onclick="playSong()">▶</button>
      <button onclick="nextSong()">⏭</button>
    </div>
  </div>
</div>

<!-- Hidden YouTube player used for playing YouTube links (keeps UI simple) -->
<div id="youtube-player" style="width:0;height:0;overflow:hidden;"></div>

<script>
/*
  Songs array:
  - If a song has `file`, the page will use the <audio> element to play it.
  - If a song has `youtubeId`, the page will load/play that video via the YouTube IFrame API.
*/
const songs = [
  {title: "Always", artist: "Artist 1", cover: "album1.jpg", file: "DIRECT_LINK_FOR_ALWAYS"},
  // I replaced the mp3 entry with your YouTube link (video id o0tqEQ331go)
  {title: "I Know You", artist: "Faye Webster", cover: "https://i.pinimg.com/736x/7e/52/26/7e5226222b95626d23fd1a2c630ad52b.jpg", youtubeId: "o0tqEQ331go"},
  {title: "Pretty Boy", artist: "Artist 3", cover: "album3.jpg", file: "DIRECT_LINK_FOR_PRETTYBOY"},
  {title: "Song 4", artist: "Artist 4", cover: "album4.jpg", file: "DIRECT_LINK_SONG4"},
  {title: "Song 5", artist: "Artist 5", cover: "album5.jpg", file: "DIRECT_LINK_SONG5"},
  {title: "Song 6", artist: "Artist 6", cover: "album6.jpg", file: "DIRECT_LINK_SONG6"}
];

let currentSong = 0;
const startBtn = document.getElementById("startBtn");
const player = document.getElementById("player");
const songTitle = document.getElementById("songTitle");
const artist = document.getElementById("artist");
const albumCover = document.getElementById("albumCover");
const audio = document.getElementById("audio");
const playBtn = document.getElementById("playBtn");

// YouTube player state
let ytPlayer = null;
let playerReady = false;
let currentVideoId = null;

// Setup start button to reveal the player
startBtn.onclick = () => {
  startBtn.style.display = "none";
  player.style.display = "block";
  updateUI();
};

// Load the IFrame API (it will call onYouTubeIframeAPIReady when ready)
const tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
document.head.appendChild(tag);

// YouTube API callback (must be global)
function onYouTubeIframeAPIReady() {
  ytPlayer = new YT.Player('youtube-player', {
    height: '0',
    width: '0',
    videoId: '',
    events: {
      onReady: () => { playerReady = true; },
      onStateChange: onPlayerStateChange
    }
  });
}

function onPlayerStateChange(event) {
  // 0 == ended
  if (event.data === YT.PlayerState.ENDED) {
    // Move to next song automatically when YouTube ends
    nextSong();
  }
  updatePlayButton();
}

function updateUI() {
  const s = songs[currentSong];
  songTitle.textContent = s.title || '';
  artist.textContent = s.artist || '';
  albumCover.src = s.cover || '';
  // If it's a local file, set the audio.src so the native controls reflect it
  if (s.file) {
    audio.src = s.file;
    audio.style.display = '';
  } else {
    audio.src = '';
    // keep audio element visible (it won't have a source) — you can hide it if you prefer
  }
  updatePlayButton();
}

function updatePlayButton() {
  const s = songs[currentSong];
  if (s.youtubeId && playerReady) {
    const playing = (currentVideoId === s.youtubeId) && (ytPlayer && ytPlayer.getPlayerState && ytPlayer.getPlayerState() === YT.PlayerState.PLAYING);
    playBtn.textContent = playing ? '⏸' : '▶';
  } else if (s.file) {
    const playing = !audio.paused && !audio.ended && audio.currentTime > 0;
    playBtn.textContent = playing ? '⏸' : '▶';
  } else {
    playBtn.textContent = '▶';
  }
}

function playSong() {
  const s = songs[currentSong];

  // If this song is a YouTube video
  if (s.youtubeId) {
    // Stop any native audio
    try { audio.pause(); } catch (e) {}
    if (!playerReady) {
      console.warn('YouTube player is not ready yet.');
      return;
    }

    // If the same video is loaded, toggle play/pause
    if (currentVideoId === s.youtubeId) {
      const state = ytPlayer.getPlayerState();
      if (state === YT.PlayerState.PLAYING) {
        ytPlayer.pauseVideo();
      } else {
        ytPlayer.playVideo();
      }
    } else {
      // Load and play the new video
      currentVideoId = s.youtubeId;
      ytPlayer.loadVideoById(currentVideoId);
      // loadVideoById will start playback because this call is triggered by a user gesture (button click)
    }
    updatePlayButton();
    return;
  }

  // Otherwise try to play a local file (or direct mp3 link)
  if (s.file) {
    // stop youtube if it was playing
    if (currentVideoId) {
      try { ytPlayer.stopVideo(); } catch (e) {}
      currentVideoId = null;
    }
    audio.play().then(() => {
      updatePlayButton();
    }).catch(err => {
      console.error('Playback failed:', err);
      // fallback: show controls so user can click native play
      audio.controls = true;
    });
  }
}

function nextSong() {
  // Stop current playback
  const current = songs[currentSong];
  if (current && current.youtubeId && currentVideoId) {
    try { ytPlayer.stopVideo(); } catch (e) {}
    currentVideoId = null;
  }
  try { audio.pause(); audio.currentTime = 0; } catch (e) {}

  // Advance index
  currentSong = (currentSong + 1) % songs.length;
  updateUI();

  // Auto-play the next song (since the user clicked next/play previously, this is still considered okay)
  const s = songs[currentSong];
  if (s.youtubeId) {
    if (playerReady) {
      currentVideoId = s.youtubeId;
      ytPlayer.loadVideoById(currentVideoId);
    }
  } else if (s.file) {
    audio.play().catch(err => console.warn('Autoplay blocked or failed:', err));
  }
}

// Keep native audio UI in sync with play/pause events
audio.addEventListener('play', updatePlayButton);
audio.addEventListener('pause', updatePlayButton);
audio.addEventListener('ended', () => {
  // if a local audio ended, move to next track
  nextSong();
});
</script>

</body>
</html>
